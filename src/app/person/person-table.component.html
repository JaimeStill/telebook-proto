@if (source) {
<div class="full-height grid">
    <div flexContainer
         flexDirection="column"
         flexMain="start"
         flexCross="stretch">
        <mat-form-field>
            <mat-label>Search</mat-label>
            <input matInput
                   (keyup)="search($event)"
                   placeholder="Search"
                   #input>
        </mat-form-field>
    </div>
    <div class="overflow">
        <table mat-table
               matSort
               multiTemplateDataRows
               [dataSource]="source">

            <ng-container matColumnDef="image">
                <th mat-header-cell
                    *matHeaderCellDef> Image </th>
                <td mat-cell
                    *matCellDef="let row">
                    <img defer
                         [src]="row.image"
                         [alt]="row.image"
                         [width]="80">
                </td>
            </ng-container>

            <ng-container matColumnDef="title">
                <th mat-header-cell
                    mat-sort-header
                    *matHeaderCellDef> Title </th>
                <td mat-cell
                    *matCellDef="let row">{{row.title}}</td>
            </ng-container>

            <ng-container matColumnDef="lastName">
                <th mat-header-cell
                    mat-sort-header
                    *matHeaderCellDef> Last Name </th>
                <td mat-cell
                    *matCellDef="let row">{{row.lastName}}</td>
            </ng-container>

            <ng-container matColumnDef="firstName">
                <th mat-header-cell
                    mat-sort-header
                    *matHeaderCellDef> First Name </th>
                <td mat-cell
                    *matCellDef="let row">{{row.firstName}}</td>
            </ng-container>

            <ng-container matColumnDef="jobTitle">
                <th mat-header-cell
                    mat-sort-header
                    *matHeaderCellDef> Job Title </th>
                <td mat-cell
                    *matCellDef="let row">{{row.jobTitle}}</td>
            </ng-container>

            <ng-container matColumnDef="organization">
                <th mat-header-cell
                    mat-sort-header
                    *matHeaderCellDef> Organization </th>
                <td mat-cell
                    *matCellDef="let row">{{row.organization}}</td>
            </ng-container>

            <ng-container matColumnDef="section">
                <th mat-header-cell
                    mat-sort-header
                    *matHeaderCellDef> Section </th>
                <td mat-cell
                    *matCellDef="let row">{{row.section}}</td>
            </ng-container>

            <ng-container matColumnDef="phone">
                <th mat-header-cell
                    mat-sort-header
                    *matHeaderCellDef> Phone </th>
                <td mat-cell
                    *matCellDef="let row">{{row.phone}}</td>
            </ng-container>

            <ng-container matColumnDef="email">
                <th mat-header-cell
                    mat-sort-header
                    *matHeaderCellDef> Email </th>
                <td mat-cell
                    *matCellDef="let row">
                    <a target="_blank"
                       [href]="'mailto:' + row.email">
                        {{row.email}}
                    </a>
                </td>
            </ng-container>

            <ng-container matColumnDef="expand">
                <th mat-header-cell
                    *matHeaderCellDef>&nbsp;</th>
                <td mat-cell
                    *matCellDef="let row">
                    @if (row === person) {
                        <mat-icon>keyboard_arrow_up</mat-icon>
                    } @else {
                        <mat-icon>keyboard_arrow_down</mat-icon>
                    }
                </td>
            </ng-container>

            <ng-container matColumnDef="expandedPerson">
                <td mat-cell
                    *matCellDef="let row"
                    [attr.colspan]="columns.length"
                    class="p0">
                    <div [@expandPerson]="row === person ? 'expanded' : 'collapsed'">
                        @if (row === person) {
                            <person-card [person]="row"></person-card>
                        }
                    </div>
                </td>
            </ng-container>

            <tr mat-header-row
                *matHeaderRowDef="columns; sticky: true"></tr>

            <tr mat-row
                class="cursor-pointer"
                [class.background-default]="row === person"
                *matRowDef="let row; columns: columns;"
                (click)="selectPerson(row); $event.stopPropagation()"></tr>

            <tr class="person-detail-row"
                mat-row
                *matRowDef="let row; columns: ['expandedPerson']"></tr>

            <tr *matNoDataRow>
                <td colspan="9"
                    class="mat-h3 p4 color-warn">No data matching the filter "{{input.value}}"</td>
            </tr>
        </table>
    </div>
    <div>
        <mat-paginator showFirstLastButtons
                       [pageSizeOptions]="[20, 50, 100]"></mat-paginator>
    </div>
</div>
}
